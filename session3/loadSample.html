<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>load sample</title>
    <script src="http://doc.gold.ac.uk/~mus02mg/_maxiLib.js"></script>

  </head>
  <body>
    <script type="text/javascript">
      var audio = new maximJs.maxiAudio();
      audio.init();

      var clk = new maximJs.maxiClock();
      clk.setTicksPerBeat(1);
      clk.setTempo(120);

      var phasor = new maximJs.maxiOsc();

      var sample = new maximJs.maxiSample();
      audio.loadSample("../sample/eg.wav", sample);

      audio.play = function() {
        clk.ticker();

        if(clk.tick) {
          sample.trigger();
          console.log("bang!");
          // clk.setTicksPerBeat(1+Math.random() * 3);
        }

        var wave = sample.play(-0.5, 0, 220500);
        // var wave = sample.playOnce(1);
        this.output = wave * 0.5;
      }
    </script>
  </body>
</html>
